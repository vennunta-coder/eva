<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>EVA</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      height: 100vh;
      background: #fff;
      color: #000;
    }
    header {
      padding: 10px 20px;
      font-size: 24px;
      font-weight: bold;
      display: flex;
      align-items: center;
    }
    header img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin-right: 10px;
    }
    main {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    #chat {
      width: 100%;
      max-width: 900px;
      flex: 1;
      overflow-y: auto;
      padding: 20px;
      display: flex;
      flex-direction: column;
    }
    .message {
      max-width: 70%;
      padding: 10px 15px;
      margin: 5px 0;
      border-radius: 12px;
      font-size: 16px;
    }
    .user {
      align-self: flex-end;
      background: #007bff;
      color: #fff;
      border-bottom-right-radius: 0;
    }
    .eva {
      align-self: flex-start;
      background: #f1f1f1;
      border-bottom-left-radius: 0;
      display: flex;
      align-items: center;
    }
    .eva img {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      margin-right: 10px;
    }
    footer {
      padding: 15px;
      text-align: center;
      font-size: 14px;
      border-top: 1px solid #ddd;
    }
    .input-area {
      display: flex;
      width: 100%;
      max-width: 900px;
      margin: 0 auto;
      padding: 10px;
    }
    .input-area input {
      flex: 1;
      padding: 12px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 20px;
      outline: none;
    }
    .input-area button {
      margin-left: 10px;
      padding: 12px 20px;
      font-size: 16px;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 20px;
      cursor: pointer;
    }
    .logo-text {
      font-size: 28px;
      font-weight: bold;
    }
    .logo-text span:nth-child(1) { color: black; }
    .logo-text span:nth-child(2) { color: orange; }
    .logo-text span:nth-child(3) { color: black; }
  </style>
</head>
<body>
  <header>
    <img src="https://raw.githubusercontent.com/vennunta-coder/eva/refs/heads/main/evalogo.png" alt="EVA Logo">
    <div class="logo-text"><span>E</span><span>V</span><span>A</span></div>
  </header>

  <main>
    <div id="chat"></div>
    <div class="input-area">
      <input type="text" id="userInput" placeholder="Pergunte qualquer coisa">
      <button onclick="sendMessage()">Enviar</button>
    </div>
  </main>

  <footer>
    <div class="logo-text"><span>E</span><span>V</span><span>A</span> © 2025</div>
  </footer>

<script>
  const chat = document.getElementById("chat");

  function addMessage(text, sender = "eva") {
    const msg = document.createElement("div");
    msg.classList.add("message", sender);
    if (sender === "eva") {
      msg.innerHTML = `<img src="https://raw.githubusercontent.com/vennunta-coder/eva/refs/heads/main/evalogo.png"> 
                       <b><span style="color:black">E</span><span style="color:orange">V</span><span style="color:black">A</span>:</b> ${text}`;
    } else {
      msg.textContent = text;
    }
    chat.appendChild(msg);
    chat.scrollTop = chat.scrollHeight;
  }

  function sendMessage() {
    const input = document.getElementById("userInput");
    const text = input.value.trim();
    if (!text) return;
    addMessage(text, "user");
    input.value = "";

    processQuestion(text);
  }

  async function processQuestion(q) {
    q = q.toLowerCase();

    // Cumprimento simples
    if (q.includes("olá") || q.includes("oi")) {
      addMessage("Olá! Como posso ajudar?");
      return;
    }

    // Clima
    if (q.includes("tempo em") || q.includes("clima em")) {
      const cidade = q.replace("tempo em","").replace("clima em","").trim();
      const clima = await getWeather(cidade);
      addMessage(clima);
      return;
    }

    // Wikipedia
    if (q.includes("wikipedia") || q.includes("quem é") || q.includes("o que é")) {
      const termo = q.replace("wikipedia","").trim();
      const resumo = await getWikipedia(termo);
      if (resumo) {
        addMessage(resumo);
        return;
      }
    }

    // Se não encontrou → tenta Google
    const googleResult = await getGoogleSearch(q);
    if (googleResult) {
      addMessage(`🔎 Encontrei isto no Google: ${googleResult}`);
      return;
    }

    // Fallback final
    addMessage("🤷‍♀️ Não encontrei nada relevante desta vez. 👉 Tente reformular a pergunta.");
  }

  // === APIs ===

  // OpenWeather
  async function getWeather(city) {
    try {
      const key = "7db838cde261492656dc201d1d17e4aa"; // tua chave OpenWeather
      const url = `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${key}&lang=pt&units=metric`;
      const res = await fetch(url);
      const data = await res.json();
      if (data.main) {
        return `🌤️ O clima em ${city} é ${data.weather[0].description}, temperatura ${data.main.temp}°C.`;
      }
      return null;
    } catch {
      return null;
    }
  }

  // Wikipedia
  async function getWikipedia(term) {
    try {
      const url = `https://pt.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(term)}`;
      const res = await fetch(url);
      const data = await res.json();
      return data.extract || null;
    } catch {
      return null;
    }
  }

  // Google Custom Search
  async function getGoogleSearch(query) {
    try {
      const apiKey = "AIzaSyBBaANH7WwPwdCw5lzkuhxTGtX77r6u5QQ"; // tua chave Google
      const cx = "81b1c6566b6be4ccf"; // ID do motor de busca (Custom Search Engine)
      const url = `https://www.googleapis.com/customsearch/v1?q=${encodeURIComponent(query)}&key=${apiKey}&cx=${cx}`;
      const res = await fetch(url);
      const data = await res.json();
      if (data.items && data.items.length > 0) {
        return `<a href="${data.items[0].link}" target="_blank">${data.items[0].title}</a> - ${data.items[0].snippet}`;
      }
      return null;
    } catch {
      return null;
    }
  }
</script>
</body>
</html>
