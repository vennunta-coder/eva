<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EVA</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #fff;
      margin: 0;
      display: flex;
      flex-direction: column;
      height: 100vh;
    }
    header {
      font-size: 23px;
      font-weight: bold;
      padding: 15px;
      color: black;
    }
    header span.v { color: orange; }
    main {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    .mensagem {
      max-width: 70%;
      padding: 10px 15px;
      border-radius: 10px;
      line-height: 1.5;
      display: flex;
      align-items: flex-start;
      gap: 10px;
    }
    .usuario {
      background: #1a73e8;
      color: white;
      margin-left: auto;
      border-radius: 10px;
    }
    .eva {
      background: #f1f1f1;
      color: black;
      margin-right: auto;
      border-radius: 10px;
    }
    .eva .avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
    }
    footer {
      text-align: center;
      padding: 10px;
      font-size: 14px;
    }
    footer span.v { color: orange; }
    .entrada {
      display: flex;
      padding: 10px;
      border-top: 1px solid #ccc;
    }
    .entrada input {
      flex: 1;
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 20px;
      outline: none;
    }
    .entrada button {
      margin-left: 10px;
      padding: 10px 20px;
      border: none;
      background: #1a73e8;
      color: white;
      border-radius: 20px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <header><span>E</span><span class="v">V</span><span>A</span></header>

  <main id="chat">
    <div class="mensagem eva">
      <img src="https://raw.githubusercontent.com/vennunta-coder/eva/refs/heads/main/evalogo.png" class="avatar">
      <div><b><span>E</span><span class="v">V</span><span>A</span>:</b> Ol√°! Em que posso ajudar?</div>
    </div>
  </main>

  <div class="entrada">
    <input type="text" id="pergunta" placeholder="Mensagem...">
    <button onclick="enviarMensagem()">Enviar</button>
  </div>

  <footer><span>E</span><span class="v">V</span><span>A</span> ¬© 2025</footer>

  <script>
    const OPENWEATHER_API_KEY = "7db838cde261492656dc201d1d17e4aa";

    // Fun√ß√£o: Clima
    async function getWeather(city) {
      const url = `https://api.openweathermap.org/data/2.5/weather?q=${encodeURIComponent(city)}&appid=${OPENWEATHER_API_KEY}&units=metric&lang=pt`;
      try {
        const response = await fetch(url);
        const data = await response.json();
        if (data.cod === 200) {
          return `üå§Ô∏è Clima em ${data.name}: ${data.weather[0].description}, ${data.main.temp}¬∞C (sensa√ß√£o ${data.main.feels_like}¬∞C), humidade ${data.main.humidity}%, vento ${data.wind.speed} km/h.`;
        } else {
          return "‚ùå N√£o consegui obter o clima agora, tente outro local.";
        }
      } catch {
        return "‚ö†Ô∏è Erro ao conectar ao servi√ßo do tempo.";
      }
    }

    // Fun√ß√£o: Processar pergunta
    async function processarPergunta(pergunta) {
      pergunta = pergunta.toLowerCase();

      // Clima
      if (pergunta.includes("tempo em") || pergunta.includes("clima em") || pergunta.includes("vai chover")) {
        let cidade = pergunta.replace("tempo em", "")
                             .replace("clima em", "")
                             .replace("vai chover em", "")
                             .trim();
        if (cidade.length > 0) {
          return await getWeather(cidade);
        } else {
          return "Por favor, diga o nome da cidade para eu verificar o clima. üåç";
        }
      }

      // Wikipedia
      if (pergunta.startsWith("quem √©") || pergunta.startsWith("o que √©") || pergunta.startsWith("onde fica")) {
        try {
          const termo = encodeURIComponent(pergunta.replace("quem √©", "")
                                                   .replace("o que √©", "")
                                                   .replace("onde fica", "").trim());
          const url = `https://pt.wikipedia.org/api/rest_v1/page/summary/${termo}`;
          const response = await fetch(url);
          const data = await response.json();
          if (data.extract) {
            return data.extract;
          } else {
            return "N√£o encontrei nada na Wikip√©dia sobre isso.";
          }
        } catch {
          return "Erro ao aceder √† Wikip√©dia.";
        }
      }

      // Fallback ‚Üí Google
      return `ü§î N√£o tenho a resposta exata, mas pode procurar no Google: https://www.google.com/search?q=${encodeURIComponent(pergunta)}`;
    }

    // Enviar mensagem
    async function enviarMensagem() {
      const input = document.getElementById("pergunta");
      const pergunta = input.value.trim();
      if (!pergunta) return;

      const chat = document.getElementById("chat");

      // Usu√°rio
      const divUser = document.createElement("div");
      divUser.className = "mensagem usuario";
      divUser.innerText = pergunta;
      chat.appendChild(divUser);

      input.value = "";

      // EVA resposta
      const resposta = await processarPergunta(pergunta);
      const divEva = document.createElement("div");
      divEva.className = "mensagem eva";
      divEva.innerHTML = `<img src="https://raw.githubusercontent.com/vennunta-coder/eva/refs/heads/main/evalogo.png" class="avatar"><div><b><span>E</span><span class="v">V</span><span>A</span>:</b> ${resposta}</div>`;
      chat.appendChild(divEva);

      chat.scrollTop = chat.scrollHeight;
    }
  </script>
</body>
</html>
